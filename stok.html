<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Spradon HafÄ±za â€“ Stok & Depo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body{
      margin:0;
      font-family:Arial, Helvetica, sans-serif;
      background:#f4f6fb;
      color:#1f2937;
    }
    .container{
      max-width:1000px;
      margin:auto;
      padding:32px;
    }
    h1{
      margin-top:0;
      font-size:26px;
    }
    .card{
      background:#fff;
      border-radius:14px;
      padding:24px;
      box-shadow:0 10px 25px rgba(0,0,0,.08);
      margin-bottom:24px;
      border:1px solid #e5e7eb;
    }
    label{
      font-weight:bold;
      font-size:14px;
      display:block;
      margin-top:12px;
    }
    input, select, textarea{
      width:100%;
      padding:10px;
      margin-top:6px;
      border-radius:8px;
      border:1px solid #d1d5db;
      font-size:14px;
    }
    textarea{resize:vertical}
    button{
      margin-top:20px;
      padding:12px 20px;
      border:none;
      border-radius:10px;
      background:#2563eb;
      color:#fff;
      font-size:15px;
      cursor:pointer;
    }
    button.secondary{
      background:#6b7280;
      margin-left:10px;
    }
    .note{
      font-size:13px;
      color:#6b7280;
      margin-top:8px;
    }
    .success{
      background:#ecfdf5;
      color:#065f46;
      padding:12px;
      border-radius:10px;
      margin-top:16px;
      display:none;
    }
  </style>
</head>
<body>

<div class="container">
  <h1>ğŸ“¦ Stok / Depo YÃ¶netimi</h1>

  <div class="card">
    <h3>â• Yeni ÃœrÃ¼n KartÄ±</h3>

    <label>ÃœrÃ¼n FotoÄŸrafÄ± (zorunlu)</label>
    <input type="file" id="foto" accept="image/*">

    <label>ÃœrÃ¼n AdÄ±</label>
    <input type="text" id="urun">

    <label>Kategori</label>
    <select id="kategori">
      <option value="">SeÃ§iniz</option>
      <option>Teknik</option>
      <option>Temizlik</option>
      <option>GÃ¼venlik</option>
      <option>Peyzaj</option>
    </select>

    <label>BaÅŸlangÄ±Ã§ Stok MiktarÄ±</label>
    <input type="number" id="stok" min="0">

    <label>Birim</label>
    <select id="birim">
      <option>Adet</option>
      <option>Kilo</option>
      <option>Litre</option>
    </select>

    <label>KaydÄ± OluÅŸturan (zorunlu)</label>
    <input type="text" id="kisi">

    <button onclick="urunKaydet()">ÃœrÃ¼n KartÄ±nÄ± Kaydet</button>

    <div class="note">
      âš ï¸ Ä°nternet yoksa kayÄ±t cihazda saklanÄ±r, baÄŸlantÄ± gelince gÃ¶nderilir.
    </div>

    <div class="success" id="okMsg">
      âœ” ÃœrÃ¼n baÅŸarÄ±yla kaydedildi.
    </div>
  </div>

  <button class="secondary" onclick="location.href='merkez.html'">
    â† Merkez Panele DÃ¶n
  </button>
</div>

<script>
const BACKEND_URL = "https://script.google.com/macros/s/AKfycbwZGhMDzmSt8PaZsQfbVPOkcEtecD2R1ASJd-6bJUjzKnof6FGwtdkoVDk_fuoJ_AAp2g/exec";

function urunKaydet(){
  const foto = document.getElementById("foto").files[0];
  const urun = document.getElementById("urun").value.trim();
  const kategori = document.getElementById("kategori").value;
  const stok = document.getElementById("stok").value;
  const birim = document.getElementById("birim").value;
  const kisi = document.getElementById("kisi").value.trim();

  if(!foto || !urun || !kategori || !kisi){
    alert("Foto, Ã¼rÃ¼n adÄ±, kategori ve kiÅŸi zorunludur.");
    return;
  }

  const reader = new FileReader();
  reader.onload = function(){
    const base64 = reader.result.split(",")[1];

    const payload = {
      action: "STOK_KART",
      urun,
      kategori,
      stok,
      birim,
      kisi,
      foto: base64
    };

    fetch(BACKEND_URL,{
      method:"POST",
      body:JSON.stringify(payload)
    })
    .then(r=>r.json())
    .then(d=>{
      document.getElementById("okMsg").style.display="block";
    })
    .catch(()=>{
      localStorage.setItem("stok_yedek_"+Date.now(), JSON.stringify(payload));
      alert("Ä°nternet yok. KayÄ±t cihazda saklandÄ±.");
    });
  };
  reader.readAsDataURL(foto);
}
</script>

</body>
</html>
